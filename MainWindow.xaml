<Window x:Class="WpfApp1_client.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:WpfApp1_client"
        mc:Ignorable="d"
        xmlns:viewModels="clr-namespace:WpfApp1_client.ViewModels"
        xmlns:converters="clr-namespace:WpfApp1_client.Converters"
        Title="Discord" 
        Height="700" 
        Width="1200"
        WindowStartupLocation="CenterScreen"
        Background="#36393f">

    <Window.Resources>

        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"></BooleanToVisibilityConverter>
        <converters:StatusToColorConverter  x:Key="StatusToColorConverter"></converters:StatusToColorConverter>
        <converters:BoolToArrowPathConverter x:Key="BoolToArrowPathConverter"/>
        <converters:CountToVisibilityConverter x:Key="CountToVisibilityConverter"/>
        <converters:StatusIndicatorConverter x:Key="StatusIndicatorConverter"/>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"></converters:BoolToVisibilityConverter>

        <!-- Стиль для прозрачных кнопок -->
        <Style x:Key="TransparentButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#3c3f45"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#4f545c"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Стиль для кнопок каналов -->
        <Style x:Key="ChannelButtonStyle" TargetType="Button" BasedOn="{StaticResource TransparentButtonStyle}">
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="HorizontalAlignment" Value="Stretch"/>
            <Setter Property="Padding" Value="8 4"/>
            <Setter Property="Margin" Value="0 2"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                        CornerRadius="4"
                        HorizontalAlignment="Stretch">
                            <ContentPresenter HorizontalAlignment="Stretch" 
                                      VerticalAlignment="Center"
                                      Margin="8 4"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#3c3f45"/>
                    <Setter Property="Foreground" Value="White"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Стиль для иконок -->
        <Style x:Key="IconButtonStyle" TargetType="Button" BasedOn="{StaticResource TransparentButtonStyle}">
            <Setter Property="Width" Value="32"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Margin" Value="2"/>
        </Style>

        <!-- Стиль для TextBox с плейсхолдером -->
        <Style x:Key="PlaceholderTextBoxStyle" TargetType="TextBox">
            <Style.Triggers>
                <Trigger Property="Text" Value="Написать сообщение в #общий">
                    <Setter Property="Foreground" Value="#72767d"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Стиль для кнопок управления -->
        <Style x:Key="ControlButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#4f545c"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="8 4"/>
            <Setter Property="Margin" Value="4"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#686d73"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Window.DataContext>
        <viewModels:MainViewModel/>
    </Window.DataContext>

    <Grid>
        <!-- Основной контейнер -->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="72"/>
                <!-- Боковая панель серверов -->
                <ColumnDefinition Width="240"/>
                <!-- Панель каналов -->
                <ColumnDefinition Width="*"/>
                <!-- Основная область чата -->
                <ColumnDefinition Width="240"/>
                <!-- Панель участников -->
            </Grid.ColumnDefinitions>

            <!-- Левая панель серверов -->
            <Border Grid.Column="0" 
                    Background="#202225">
                <StackPanel>

                    <!-- Кнопка личных сообщений -->
                    <Border Width="48" 
                            Height="48" 
                            CornerRadius="24" 
                            Background="#36393f" 
                            Margin="12 8">
                        <Border.Effect>
                            <DropShadowEffect ShadowDepth="0" 
                                               BlurRadius="10" 
                                               Opacity="0.3"/>
                        </Border.Effect>
                        <Button Style="{StaticResource TransparentButtonStyle}" >
                            <Viewbox Width="24" Height="24">
                                <Path Data="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM6 7H18V9H6V7ZM6 11H18V13H6V11ZM6 15H12V17H6V15Z" 
                                      Fill="#ffffff" 
                                      Stretch="Uniform"/>
                            </Viewbox>
                        </Button>
                    </Border>

                    <!-- Разделитель -->
                    <Border Height="2" 
                            Background="#2f3136" 
                            Margin="16 4"/>

                    <!-- Список серверов -->
                    <ScrollViewer VerticalScrollBarVisibility="Hidden" DockPanel.Dock="Top"
                  MaxHeight="500" >
                        
                        <ItemsControl>

                            <!-- Динамические серверы -->
                            <ItemsControl ItemsSource="{Binding CurrentServersView}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Button Background="#202225" FocusVisualStyle="{x:Null}" BorderThickness="0"
                            Command="{Binding DataContext.JoinServerCommand,
                                            RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"
                            CommandParameter="{Binding}">
                                            
                                            
                                            <Border Width="48" Height="48" CornerRadius="24" 
                                Background="{Binding ServerColor}" Margin="0 8">
                                                <TextBlock Text="{Binding ShortName}" 
                                       Foreground="White" FontWeight="Bold" FontSize="16"
                                       HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                        </Button>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>

                            <!-- Кнопка добавления сервера -->
                            <Border Width="48" 
                                    Height="48" 
                                    CornerRadius="24" 
                                    Background="#36393f" 
                                    Margin="12 8">
                                <Button   x:Name="SettingsButton" Visibility="{Binding IsInputVisible, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=invert}" Style="{StaticResource TransparentButtonStyle}" Command="{Binding CreateServerCommand}">

                                    <Viewbox Width="20" Height="20">
                                        <Path Data="M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z" 
                                              Fill="#3ba55d" 
                                              Stretch="Uniform"/>

                                    </Viewbox>
                                </Button>

                            </Border>
                            <StackPanel Visibility="{Binding IsInputVisible, Converter={StaticResource BoolToVisibilityConverter}}"
                   Margin="0,10,0,0">

                                <TextBlock Text="Введите значение:" 
                      Margin="0,0,0,5"/>

                                <TextBox Text="{Binding InputText, UpdateSourceTrigger=PropertyChanged}"
                    Width="200"
                    Margin="0,0,0,5">
                                    <TextBox.InputBindings>
                                        <KeyBinding Key="Enter" Command="{Binding ApplyCommand}"/>
                                    </TextBox.InputBindings>
                                </TextBox>

                                <Button Content="Применить" 
                   Command="{Binding ApplyCommand}"
                   Width="100"/>
                            </StackPanel>
                      
                        
                        </ItemsControl>

                    </ScrollViewer>
               
                
                </StackPanel>
            </Border>

            <!-- Панель каналов и друзей -->
            <Grid Grid.Column="1" 
                  Background="#2f3136">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Заголовок сервера -->
                <Border Grid.Row="0" 
                        Background="#2f3136" 
                        BorderThickness="0 0 0 1" 
                        BorderBrush="#202225">
                    <StackPanel Orientation="Horizontal" 
                                Height="48">
                        <TextBlock Text="Discord Server" 
                                   Foreground="White" 
                                   FontWeight="Bold" 
                                   FontSize="16"
                                   VerticalAlignment="Center"
                                   Margin="16 0 0 0"/>
                        <Button Style="{StaticResource TransparentButtonStyle}" 
                                Margin="8 0 0 0">
                            <Viewbox Width="18" Height="18">
                                <Path Data="M7 10L12 15L17 10H7Z" 
                                      Fill="#8e9297" 
                                      Stretch="Uniform"/>
                            </Viewbox>
                        </Button>
                    </StackPanel>
                </Border>


                <!-- Список каналов -->
                <!-- Список каналов -->
                <ScrollViewer Grid.Row="1" 
              VerticalScrollBarVisibility="Auto" >
                    <StackPanel > 
                        <!-- Категория текстовых каналов -->
                        <StackPanel Margin="16 8 16 0">
                            <StackPanel Orientation="Horizontal">
                                <Button Style="{StaticResource TransparentButtonStyle}">
                                    <Viewbox Width="12" Height="12">
                                        <Path Data="M7 10L12 15L17 10H7Z" 
                              Fill="#8e9297" 
                              Stretch="Uniform"/>
                                    </Viewbox>
                                </Button>
                                <TextBlock Text="ТЕКСТОВЫЕ КАНАЛЫ" 
                           Foreground="#8e9297" 
                           FontSize="12" 
                           FontWeight="Bold"
                           Margin="8 0 0 0"/>
                            </StackPanel>

                            <!-- Существующие текстовые каналы -->
                            <Button Style="{StaticResource ChannelButtonStyle}">
                                <StackPanel Orientation="Horizontal">
                                    <Viewbox Width="16" Height="16" Margin="0 0 6 0">
                                        <Path Data="M5 3L19 12L5 21V3Z" 
                              Fill="#8e9297" 
                              Stretch="Uniform"/>
                                    </Viewbox>
                                    <TextBlock Text="#общий" 
                               Foreground="#8e9297"/>
                                </StackPanel>
                            </Button>
                            <Button Style="{StaticResource ChannelButtonStyle}">
                                <StackPanel Orientation="Horizontal">
                                    <Viewbox Width="16" Height="16" Margin="0 0 6 0">
                                        <Path Data="M5 3L19 12L5 21V3Z" 
                              Fill="#8e9297" 
                              Stretch="Uniform"/>
                                    </Viewbox>
                                    <TextBlock Text="#новости" 
                               Foreground="#8e9297"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>

                        <!-- Динамические голосовые каналы -->
                        <ItemsControl ItemsSource="{Binding ChannelCategories}">
                            <ItemsControl.ItemTemplate>

                                <DataTemplate>
                                    <StackPanel Margin="16 16 16 0">
                                        <!-- Заголовок категории -->
                                        <StackPanel Orientation="Horizontal">
                                            <Button Style="{StaticResource TransparentButtonStyle}"
                                    Command="{Binding ToggleExpandCommand}">
                                                <Viewbox Width="12" Height="12">
                                                    <Path Data="{Binding IsExpanded, Converter={StaticResource BoolToArrowPathConverter}}"
                                          Fill="#8e9297" 
                                          Stretch="Uniform"/>
                                                </Viewbox>
                                            </Button>
                                            <TextBlock Text="{Binding Name}" 
                                       Foreground="#8e9297" 
                                       FontSize="12" 
                                       FontWeight="Bold"
                                       Margin="8 0 0 0"/>
                                        </StackPanel>

                                        <!-- Список голосовых каналов -->
                                        <ItemsControl ItemsSource="{Binding Channels}"
                                      Margin="8 4 0 0"
                                      Visibility="{Binding IsExpanded, Converter={StaticResource BooleanToVisibilityConverter}}">
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Border Margin="0 2" Padding="0 4">
                                                        <!-- Кнопка канала -->
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                            </Grid.RowDefinitions>

                                                            <Button Grid.Row="0"
                    Style="{StaticResource ChannelButtonStyle}"
                    Command="{Binding JoinChannelCommand}"
                    Margin="0">
                                                                <StackPanel Orientation="Horizontal">
                                                                    <Viewbox Width="16" Height="16" Margin="0 0 6 0">
                                                                        <Path Data="M12 3L3 9V15L12 21V3Z" 
                              Fill="{Binding ChannelForeground}" 
                              Stretch="Uniform"/>
                                                                    </Viewbox>
                                                                    <TextBlock Text="{Binding Name}" 
                               Foreground="{Binding ChannelForeground}"/>
                                                                </StackPanel>
                                                            </Button>

                                                            <!-- Список участников в канале -->
                                                            <ItemsControl Grid.Row="1"
                          ItemsSource="{Binding ConnectedMembers}"
                          Margin="24 2 0 0"
                          Visibility="{Binding ConnectedMembers.Count, Converter={StaticResource CountToVisibilityConverter}}">
                                                                <ItemsControl.ItemTemplate>
                                                                    <DataTemplate>
                                                                        <StackPanel Orientation="Horizontal" 
                                    Margin="0 10 0 0">
                                                                            <Border Width="16" 
                                    Height="16" 
                                    CornerRadius="10" 
                                    Background="{Binding AvatarColor}">
                                                                                <TextBlock Text="{Binding Initials}" 
                                           Foreground="White" 
                                           FontWeight="Bold"
                                           FontSize="8"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"/>
                                                                            </Border>
                                                                            <TextBlock Text="{Binding Username}" 
                                       Foreground="#8e9297" 
                                       FontSize="11"
                                       Margin="4 0 0 0"
                                       VerticalAlignment="Center"/>
                                                                        </StackPanel>
                                                                    </DataTemplate>
                                                                </ItemsControl.ItemTemplate>
                                                            </ItemsControl>
                                                        </Grid>
                                                    </Border>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                   
                                    
                                    </StackPanel>
                                </DataTemplate>


                            </ItemsControl.ItemTemplate>
                        </ItemsControl>

                        <!-- Кнопка создания голосового канала -->
                        <Button Style="{StaticResource ChannelButtonStyle}"
                Command="{Binding CreateVoiceChannelCommand}"
                Margin="16 8 16 8">
                            <StackPanel Orientation="Horizontal">
                                <Viewbox Width="16" Height="16" Margin="0 0 6 0">
                                    <Path Data="M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z" 
                          Fill="#8e9297" 
                          Stretch="Uniform"/>
                                </Viewbox>
                                <TextBlock Text="Создать голосовой канал" 
                           Foreground="#8e9297"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </ScrollViewer>

                <!-- Панель пользователя -->
                <Border Grid.Row="2" 
                        Background="#292b2f" 
                        Height="52">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- Аватар пользователя -->
                        <Border Grid.Column="0" 
                Width="32" 
                Height="32" 
                CornerRadius="16" 
                Background="{Binding CurrentUser.UserColor}"
                Margin="8">
                            <TextBlock Text="{Binding CurrentUser.Initials}" 
                       Foreground="White" 
                       FontWeight="Bold"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"/>
                        </Border>

                        <!-- Имя пользователя -->
                        <StackPanel Grid.Column="1" 
                    VerticalAlignment="Center" 
                    Margin="8 0 0 0">
                            <TextBlock Text="{Binding CurrentUser.Name}" 
                       Foreground="White" 
                       FontWeight="SemiBold"
                       FontSize="14"/>
                            <TextBlock Text="{Binding CurrentUser.Status}" 
                       Foreground="#43b581" 
                       FontSize="12"/>
                        </StackPanel>

                        <!-- Иконки управления -->
                        <StackPanel Grid.Column="2" 
                    Orientation="Horizontal" 
                    Margin="0 0 8 0">
                            <Button Style="{StaticResource IconButtonStyle}"
                    Command="{Binding ToggleCurrentUserStatusCommand}">
                                <Viewbox Width="20" Height="20">
                                    <Path Data="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2Z" 
                          Fill="{Binding CurrentUser.Status, Converter={StaticResource StatusIndicatorConverter}}"
                          Stretch="Uniform"/>
                                </Viewbox>
                            </Button>

                            <Button Style="{StaticResource IconButtonStyle}">
                                <Viewbox Width="20" Height="20">
                                    <Path Data="M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z" 
                          Fill="#b9bbbe" 
                          Stretch="Uniform"/>
                                </Viewbox>
                            </Button>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>

            <!-- Основная область чата -->
            <Grid Grid.Column="2" 
                  Background="#36393f">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Заголовок канала -->
                <Border Grid.Row="0" 
                        Background="#36393f" 
                        BorderThickness="0 0 0 1" 
                        BorderBrush="#202225">
                    <Grid>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Orientation="Horizontal" 
                                    Height="48"
                                    VerticalAlignment="Center">
                            <Viewbox Width="24" Height="24" 
                                     Margin="16 0 8 0">
                                <Path Data="M6 18L7.41 19.41L12 14.83L16.59 19.41L18 18L12 12L6 18ZM6 6L12 12L18 6L16.59 4.59L12 9.17L7.41 4.59L6 6Z" 
                                      Fill="#8e9297" 
                                      Stretch="Uniform"/>
                            </Viewbox>
                            <TextBlock Text="# общий" 
                                       Foreground="White" 
                                       FontWeight="Bold" 
                                       FontSize="16"
                                       VerticalAlignment="Center"/>
                        </StackPanel>

                        <!-- Панель управления участниками -->
                        <StackPanel Grid.Column="1"
                                    Orientation="Horizontal" 
                                    HorizontalAlignment="Right" 
                                    Margin="0 0 16 0"
                                    VerticalAlignment="Center">
                            <!--
                            <Button Content="Добавить" 
                                    Command="{Binding AddTestMemberCommand}"
                                    Style="{StaticResource ControlButtonStyle}"/>

                            <Button Content="Переключить статус" 
                                    Command="{Binding ToggleRandomMemberCommand}"
                                    Style="{StaticResource ControlButtonStyle}"/>
                            -->
                            <!-- Панель инструментов канала -->
                            <Button Style="{StaticResource IconButtonStyle}">
                                <Viewbox Width="20" Height="20">
                                    <Path Data="M12 8C13.1 8 14 7.1 14 6C14 4.9 13.1 4 12 4C10.9 4 10 4.9 10 6C10 7.1 10.9 8 12 8ZM12 10C10.9 10 10 10.9 10 12C10 13.1 10.9 14 12 14C13.1 14 14 13.1 14 12C14 10.9 13.1 10 12 10ZM12 16C10.9 16 10 16.9 10 18C10 19.1 10.9 20 12 20C13.1 20 14 19.1 14 18C14 16.9 13.1 16 12 16Z" 
                                          Fill="#b9bbbe" 
                                          Stretch="Uniform"/>
                                </Viewbox>
                            </Button>

                            <Button Style="{StaticResource IconButtonStyle}">
                                <Viewbox Width="20" Height="20">
                                    <Path Data="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20ZM12 6C9.79 6 8 7.79 8 10C8 12.21 9.79 14 12 14C14.21 14 16 12.21 16 10C16 7.79 14.21 6 12 6ZM12 12C10.9 12 10 11.1 10 10C10 8.9 10.9 8 12 8C13.1 8 14 8.9 14 10C14 11.1 13.1 12 12 12ZM18 17.13C16.47 15.77 14.4 15 12 15C9.6 15 7.53 15.77 6 17.13V16C6 13.34 8.69 11 12 11C15.31 11 18 13.34 18 16V17.13Z" 
                                          Fill="#b9bbbe" 
                                          Stretch="Uniform"/>
                                </Viewbox>
                            </Button>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Область сообщений -->
                <ScrollViewer Grid.Row="1" 
                              VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="16">
                        <!-- Пример сообщения -->
                        <Grid Margin="0 8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Аватар отправителя -->
                            <Border Grid.Column="0" 
                                    Width="40" 
                                    Height="40" 
                                    CornerRadius="20" 
                                    Background="#5865f2"
                                    Margin="0 0 16 0">
                                <TextBlock Text="U" 
                                           Foreground="White" 
                                           FontWeight="Bold"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"/>
                            </Border>

                            <!-- Сообщение -->
                            <StackPanel Grid.Column="1">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Username" 
                                               Foreground="White" 
                                               FontWeight="SemiBold"/>
                                    <TextBlock Text="Сегодня в 14:30" 
                                               Foreground="#72767d" 
                                               Margin="8 0 0 0"/>
                                </StackPanel>
                                <TextBlock Text="Привет! Как дела?" 
                                           Foreground="#dcddde" 
                                           Margin="0 4 0 0"/>
                            </StackPanel>
                        </Grid>

                        <!-- Еще одно сообщение -->
                        <Grid Margin="0 8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Аватар отправителя -->
                            <Border Grid.Column="0" 
                                    Width="40" 
                                    Height="40" 
                                    CornerRadius="20" 
                                    Background="#43b581"
                                    Margin="0 0 16 0">
                                <TextBlock Text="A" 
                                           Foreground="White" 
                                           FontWeight="Bold"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"/>
                            </Border>

                            <!-- Сообщение -->
                            <StackPanel Grid.Column="1">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="AnotherUser" 
                                               Foreground="White" 
                                               FontWeight="SemiBold"/>
                                    <TextBlock Text="Сегодня в 14:31" 
                                               Foreground="#72767d" 
                                               Margin="8 0 0 0"/>
                                </StackPanel>
                                <TextBlock Text="Всем привет! Отлично, спасибо!" 
                                           Foreground="#dcddde" 
                                           Margin="0 4 0 0"/>
                            </StackPanel>
                        </Grid>

                        <!-- Сообщение о добавлении участников -->
                        <Border Background="#36393f" 
                                CornerRadius="4" 
                                Margin="0 16" 
                                Padding="8">
                            <TextBlock Text="Используйте кнопки 'Добавить' и 'Переключить статус' для тестирования динамического списка участников" 
                                       Foreground="#8e9297" 
                                       FontStyle="Italic"
                                       TextWrapping="Wrap"/>
                        </Border>
                    </StackPanel>
                </ScrollViewer>

                <!-- Панель ввода сообщения -->
                <Border Grid.Row="2" 
                        Background="#40444b" 
                        Margin="16" 
                        CornerRadius="8">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- Кнопки прикрепления -->
                        <StackPanel Grid.Column="0" 
                                    Orientation="Horizontal" 
                                    Margin="8">
                            <Button Style="{StaticResource IconButtonStyle}">
                                <Viewbox Width="20" Height="20">
                                    <Path Data="M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z" 
                                          Fill="#b9bbbe" 
                                          Stretch="Uniform"/>
                                </Viewbox>
                            </Button>
                        </StackPanel>

                        <!-- Поле ввода -->
                        <TextBox Grid.Column="1" 
                                 Background="Transparent" 
                                 BorderThickness="0" 
                                 Foreground="White"
                                 FontSize="14"
                                 VerticalContentAlignment="Center"
                                 Padding="8 0"
                                 Text="Написать сообщение в #общий"
                                 Style="{StaticResource PlaceholderTextBoxStyle}"/>

                        <!-- Кнопки отправки -->
                        <StackPanel Grid.Column="2" 
                                    Orientation="Horizontal" 
                                    Margin="8">
                            <Button Style="{StaticResource IconButtonStyle}">
                                <Viewbox Width="20" Height="20">
                                    <Path Data="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20ZM12 6C9.79 6 8 7.79 8 10C8 12.21 9.79 14 12 14C14.21 14 16 12.21 16 10C16 7.79 14.21 6 12 6ZM12 12C10.9 12 10 11.1 10 10C10 8.9 10.9 8 12 8C13.1 8 14 8.9 14 10C14 11.1 13.1 12 12 12ZM18 17.13C16.47 15.77 14.4 15 12 15C9.6 15 7.53 15.77 6 17.13V16C6 13.34 8.69 11 12 11C15.31 11 18 13.34 18 16V17.13Z" 
                                          Fill="#b9bbbe" 
                                          Stretch="Uniform"/>
                                </Viewbox>
                            </Button>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>

            <!-- Правая панель участников -->
            <Grid Grid.Column="3" 
                  Background="#2f3136">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Заголовок -->
                <Border Grid.Row="0" 
                        Background="#2f3136" 
                        BorderThickness="0 0 0 1" 
                        BorderBrush="#202225">
                    <TextBlock Text="{Binding MemberCountText}" 
                               Foreground="#8e9297" 
                               FontWeight="Bold" 
                               FontSize="12"
                               Padding="16 16"/>
                </Border>

                <!-- Список участников -->
                <ScrollViewer Grid.Row="1" 
                              VerticalScrollBarVisibility="Auto"
                              VerticalAlignment="Stretch">
                    <StackPanel>
                        <!-- Онлайн участники -->
                        <StackPanel Visibility="{Binding HasOnlineMembers, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <TextBlock Text="{Binding OnlineMembersHeader}" 
                                       Foreground="#8e9297" 
                                       FontWeight="Bold" 
                                       FontSize="12"
                                       Margin="8 16 8 8"/>

                            <!-- Динамический список онлайн участников -->
                            <ItemsControl ItemsSource="{Binding OnlineMembersView}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" 
                                                    Margin="8 4">
                                            <Border Width="32" 
                                                    Height="32" 
                                                    CornerRadius="16" 
                                                    Background="{Binding UserColor}">
                                                <TextBlock Text="{Binding Initials}" 
                                                           Foreground="White" 
                                                           FontWeight="Bold"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center"/>
                                            </Border>
                                            <StackPanel VerticalAlignment="Center" 
                                                        Margin="8 0 0 0">
                                                <TextBlock Text="{Binding Name}"
                                                           Foreground="{Binding Online, Converter={StaticResource StatusToColorConverter}}"/>
                                                <TextBlock Text="{Binding Status}" 
                                                           Foreground="#43b581" 
                                                           FontSize="11"
                                                           Visibility="{Binding HasStatus, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>

                        <!-- Участники с другими статусами -->
                        <StackPanel Visibility="{Binding HasAwayMembers, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <TextBlock Text="{Binding AwayMembersHeader}" 
                                       Foreground="#8e9297" 
                                       FontWeight="Bold" 
                                       FontSize="12"
                                       Margin="8 16 8 8"/>

                            <ItemsControl ItemsSource="{Binding AwayMembersView}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" 
                                                    Margin="8 4">
                                            <Border Width="32" 
                                                    Height="32" 
                                                    CornerRadius="16" 
                                                    Background="{Binding AvatarColor}">
                                                <TextBlock Text="{Binding Initials}" 
                                                           Foreground="White" 
                                                           FontWeight="Bold"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center"/>
                                            </Border>
                                            <StackPanel VerticalAlignment="Center" 
                                                        Margin="8 0 0 0">
                                                <TextBlock Text="{Binding Username}" 
                                                           Foreground="{Binding IsOnline, Converter={StaticResource StatusToColorConverter}}"/>
                                                <TextBlock Text="{Binding StatusText}" 
                                                           Foreground="#faa81a" 
                                                           FontSize="11"
                                                           Visibility="{Binding HasStatus, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>

                        <!-- Оффлайн участники -->
                        <StackPanel Visibility="{Binding HasOfflineMembers, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <TextBlock Text="{Binding OfflineMembersHeader}" 
                                       Foreground="#8e9297" 
                                       FontWeight="Bold" 
                                       FontSize="12"
                                       Margin="8 16 8 8"/>

                            <!-- Динамический список оффлайн участников -->
                            <ItemsControl ItemsSource="{Binding OfflineMembersView}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" 
                                                    Margin="8 4">
                                            <Border Width="32" 
                                                    Height="32" 
                                                    CornerRadius="16" 
                                                    Background="{Binding UserColor}">
                                                <TextBlock Text="{Binding Initials}" 
                                                           Foreground="White" 
                                                           FontWeight="Bold"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center"/>
                                            </Border>
                                            <StackPanel VerticalAlignment="Center" 
                                                        Margin="8 0 0 0">
                                                <TextBlock Text="{Binding Name}"
                                                           Foreground="{Binding Offline, Converter={StaticResource StatusToColorConverter}}"/>
                                                <TextBlock Text="{Binding Status}" 
                                                           Foreground="#43b581" 
                                                           FontSize="11"
                                                           Visibility="{Binding HasStatus, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>

                        <!-- Информация об управлении -->
                        <Border Background="#2f3136" 
                                CornerRadius="4" 
                                Margin="8" 
                                Padding="8"
                                BorderBrush="#40444b"
                                BorderThickness="1">
                            <TextBlock Text="Список участников " 
                                       Foreground="#8e9297" 
                                       FontSize="11"
                                       TextWrapping="Wrap"
                                       TextAlignment="Center"/>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </Grid>
    </Grid>



</Window>
